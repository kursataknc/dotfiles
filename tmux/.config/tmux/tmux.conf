# ==========================================
# TMUX CONFIGURATION
# ==========================================
# Organized by: General, Terminal, Visual, Keybindings, Plugins, Theme
# Last updated: 2025-12-10
# ==========================================

# ==========================================
# RESET & INITIALIZATION
# ==========================================
source-file ~/.config/tmux/tmux.reset.conf

# ==========================================
# GENERAL SETTINGS
# ==========================================
set -g prefix ^A                 # Set prefix key to Ctrl+A
set -g mouse on                  # Enable mouse support
set -g base-index 1              # Start indexing windows at 1 instead of 0
set -g escape-time 0             # Zero-out escape time delay
set -g history-limit 1000000     # Increase history size (from 2,000)
set -g detach-on-destroy off     # Don't exit from tmux when closing a session
set -g renumber-windows on       # Renumber all windows when any window is closed
set -g set-clipboard on          # Use system clipboard
setw -g mode-keys vi             # Use vi keybindings in copy mode

# ==========================================
# TERMINAL SETTINGS
# ==========================================
set-option -g default-terminal 'tmux-256color'
set-option -g terminal-overrides ',xterm-256color:RGB'
set-option -g default-shell /opt/homebrew/bin/nu
set -g default-terminal "${TERM}"

# ==========================================
# VISUAL SETTINGS
# ==========================================
# Status Bar
set -g status-position top       # Position status bar at the top (macOS style)
set -g status-right-length 200
set -g status-left-length 200

# Pane Borders
set -g pane-active-border-style 'fg=magenta,bg=default'
set -g pane-border-style 'fg=brightblack,bg=default'

# ==========================================
# KEY BINDINGS
# ==========================================
bind r source-file ~/.config/tmux/tmux.conf \; display "Config reloaded!"

# ==========================================
# PLUGINS
# ==========================================
# Plugin Manager
set -g @plugin 'tmux-plugins/tpm'

# Core Functionality
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'b0o/tmux-autoreload'

# Copy & Clipboard
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-copycat'

# Navigation & Session Management
set -g @plugin 'sainnhe/tmux-fzf'
set -g @plugin 'wfxr/tmux-fzf-url'
set -g @plugin 'omerxx/tmux-sessionx'
set -g @plugin 'trevarj/tmux-open-nvim'
set -g @plugin 'kiyoon/treemux'

# User Interface
set -g @plugin 'whame/tmux-modal'
set -g @plugin 'jaclu/tmux-mouse-swipe'
set -g @plugin 'jaclu/tmux-menus'

# System Monitoring
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'thewtex/tmux-mem-cpu-load'
set -g @plugin 'robhurring/tmux-uptime'
set -g @plugin 'kursataknc/tmux-ip-address'
set -g @plugin 'kursataknc/tmux-net-speed'

# Media & Display
set -g @plugin 'spywhere/tmux-now-playing'
# set -g @plugin 'joshmedeski/tmux-nerd-font-window-name'

# Weather
set -g @plugin 'aaronpowell/tmux-weather'

# Theme
set -g @plugin 'catppuccin/tmux#v2.1.3'

# ==========================================
# PLUGIN CONFIGURATIONS
# ==========================================

# --- SessionX ---
set -g @sessionx-bind 'o'
set -g @sessionx-bind-zo-new-window 'ctrl-y'
set -g @sessionx-auto-accept 'off'
set -g @sessionx-custom-paths '/Users/kursataknc/dotfiles'
set -g @sessionx-x-path '~/dotfiles'
set -g @sessionx-window-height '85%'
set -g @sessionx-window-width '75%'
set -g @sessionx-zoxide-mode 'on'
set -g @sessionx-custom-paths-subdirectories 'false'
set -g @sessionx-filter-current 'false'

# --- Resurrect & Continuum ---
set -g @resurrect-strategy-nvim 'session'
# set -g @continuum-restore 'on'

# --- FZF URL ---
set -g @fzf-url-fzf-options '-p 60%,30% --prompt="   " --border-label=" Open URL "'
set -g @fzf-url-history-limit '2000'

# --- Menus ---
set -g @menus_trigger 'Space'

# --- Now Playing ---
set -g @now-playing-scrollable-format "{artist} - {title}"
set -g @now-playing-status-format "{icon} {scrollable}"
set -g @now-playing-playing-icon "♫"
set -g @now-playing-paused-icon "⏸"
set -g @now-playing-stopped-icon "⏹"

# --- Weather ---
set -g @forecast-location "Ankara"
set -g @forecast-format "%c+%t"

# --- IP Address ---
set -g @ip_address_mode 'local'
set -g @ip_address_status_side 'status-left'

# --- Net Speed ---
set -g @net_speed_interfaces 'en0'
set -g @download_speed_format "%s"
set -g @upload_speed_format "%s"
set -g @net_speed_format "↓%s ↑%s"

# --- Treemux ---
set -g @treemux-tree-client 'nvim-tree'
set -g @treemux-tree-nvim-init-file '~/.config/tmux/plugins/treemux/configs/treemux_init.lua'
set -g @treemux-python-command '/path/to/python3'
# set -g @treemux-nvim-command 'NVIM_APPNAME=nvim-treemux nvim'


# ==========================================
# THEME CONFIGURATION (Catppuccin)
# ==========================================
set -g @catppuccin_flavor 'mocha'
set -g @catppuccin_window_status_style "none"


# Load Catppuccin
run ~/.config/tmux/plugins/tmux/catppuccin.tmux

# Completely disable window list
setw -g window-status-format ""
setw -g window-status-current-format ""

# Status Bar Layout
# Left Side: Session, Running Command, CPU, RAM, IP, Net Speed, Weather
set -g status-left "#[bg=#{@thm_bg},fg=#{@thm_green}]  #S "
set -ag status-left "#[bg=#{@thm_bg},fg=#{@thm_sky}]  #{pane_current_command} "
set -ag status-left "#[bg=#{@thm_bg},fg=#{@thm_yellow}] #{forecast} "
set -ag status-left "#[bg=#{@thm_bg},fg=#{@thm_pink}] 󰻠 #{cpu_percentage} "
set -ag status-left "#[bg=#{@thm_bg},fg=#{@thm_teal}] 󰍛 #{ram_percentage} "
set -ag status-left "#[bg=#{@thm_bg},fg=#{@thm_blue}] 󰩟 #{ip_address} "
set -ag status-left "#[bg=#{@thm_bg},fg=#{@thm_peach}] 󰓅 #{net_speed} "

# Right Side: Now Playing, Directory, Date
set -g status-right ""
set -ag status-right "#[bg=colour234,fg=colour37] #{now_playing} "
set -ag status-right "#[bg=#{@thm_bg},fg=#{@thm_maroon}] 󰉋 #{pane_current_path} "
set -ag status-right "#[bg=#{@thm_bg},fg=#{@thm_mauve}] 󰃭 %a %d.%m.%Y %H.%M"

# ==========================================
# INITIALIZATION
# ==========================================
if "test ! -d ~/.config/tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm ~/.config/tmux/plugins/tpm && ~/.config/tmux/plugins/tpm/bin/install_plugins'"

run '~/.config/tmux/plugins/tpm/tpm'
